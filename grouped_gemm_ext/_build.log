[1/3] c++ -MMD -MF bindings.o.d -DTORCH_EXTENSION_NAME=groupedmm_ext -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1018\" -isystem /home/jeromeku/cutlass/.cutlass-env/lib/python3.12/site-packages/torch/include -isystem /home/jeromeku/cutlass/.cutlass-env/lib/python3.12/site-packages/torch/include/torch/csrc/api/include -isystem /home/jeromeku/.local/share/uv/python/cpython-3.12.11-linux-x86_64-gnu/include/python3.12 -fPIC -std=c++17 -O3 -std=c++17 -Icsrc -I/home/jeromeku/cutlass/include -I/home/jeromeku/cutlass/tools/util/include -c /home/jeromeku/cutlass/grouped_gemm_ext/csrc/bindings.cpp -o bindings.o 
[2/3] /usr/bin/nvcc --generate-dependencies-with-compile --dependency-output GroupMM.cuda.o.d -DTORCH_EXTENSION_NAME=groupedmm_ext -DTORCH_API_INCLUDE_EXTENSION_H -DPYBIND11_COMPILER_TYPE=\"_gcc\" -DPYBIND11_STDLIB=\"_libstdcpp\" -DPYBIND11_BUILD_ABI=\"_cxxabi1018\" -isystem /home/jeromeku/cutlass/.cutlass-env/lib/python3.12/site-packages/torch/include -isystem /home/jeromeku/cutlass/.cutlass-env/lib/python3.12/site-packages/torch/include/torch/csrc/api/include -isystem /home/jeromeku/.local/share/uv/python/cpython-3.12.11-linux-x86_64-gnu/include/python3.12 -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr -gencode=arch=compute_90,code=sm_90 --compiler-options '-fPIC' -O3 -std=c++17 --expt-relaxed-constexpr --expt-extended-lambda -gencode=arch=compute_90a,code=sm_90a -Icsrc -I/home/jeromeku/cutlass/include -I/home/jeromeku/cutlass/tools/util/include -c /home/jeromeku/cutlass/grouped_gemm_ext/csrc/GroupMM.cu -o GroupMM.cuda.o 
ptxas info    : (C7510) Potential Performance Loss: wgmma.mma_async instructions are serialized due to wgmma pipeline crossing function boundary at a function call in the function '_ZN7cutlass13device_kernelIN13groupedmm_ext25enable_3x_kernel_for_sm9xINS_4gemm6kernel13GemmUniversalINS3_17GroupProblemShapeIN4cute5tupleIJiiiEEEEENS3_10collective13CollectiveMmaINS3_39MainloopSm90ArrayTmaGmmaWarpSpecializedILi4ENS8_IJNS7_1CILi2EEENSE_ILi1EEESG_EEENS3_43KernelPtrArrayTmaWarpSpecializedCooperativeEEENS8_IJNSE_ILi128EEENSE_ILi256EEENSE_ILi64EEEEEENS_10bfloat16_tEPNS8_IJSG_lNSE_ILi0EEEEEESO_PNS8_IJlSG_SP_EEENS7_8TiledMMAINS7_8MMA_AtomIJNS7_4SM904GMMA28MMA_64x256x16_F32BF16BF16_SSILNSX_5MajorE1ELSZ_0ELNSX_7ScaleInE1ELS10_1EEEEEENS7_6LayoutISH_NS8_IJSG_SP_SP_EEEEENS8_IJNS7_10UnderscoreES16_S16_EEEEENS7_13SM90_TMA_LOADENS7_14ComposedLayoutINS7_7SwizzleILi3ELi4ELi3EEENS7_18smem_ptr_flag_bitsILi16EEENS13_INS8_IJSM_NSE_ILi8EEEEEENS8_IJSG_SM_EEEEEEEvNS7_8identityENS7_23SM90_TMA_LOAD_MULTICASTENS1A_IS1C_S1E_NS13_INS8_IJS1F_SM_EEENS8_IJSM_SG_EEEEEEEvS1K_EENS_8epilogue10collective18CollectiveEpilogueINS1R_30Sm90PtrArrayTmaWarpSpecializedILi4ELi2ELi16ELb1ELb0ELi2EEEJSN_NS8_IJSK_NSE_ILi32EEEEEESO_ST_SO_ST_NS1R_6fusion15FusionCallbacksIS1V_NS1Y_17LinearCombinationISO_fSO_fLNS_15FloatRoundStyleE2EEESN_S1X_JEEES19_NS1A_INS1B_ILi2ELi4ELi3EEES1E_NS13_INS8_IJS1F_S1W_EEENS8_IJS1W_SG_EEEEEEENS7_17SM75_U32x4_LDSM_NENS7_14SM90_TMA_STOREES28_NS7_17SM90_U32x4_STSM_NENS7_9Copy_AtomIJS2B_NS_6half_tEEEEvEEEvvEEEEEEvNT_6ParamsE'
ptxas info    : (C7510) Potential Performance Loss: wgmma.mma_async instructions are serialized due to wgmma pipeline crossing function boundary at a function call in the function '_ZN7cutlass13device_kernelIN13groupedmm_ext25enable_3x_kernel_for_sm9xINS_4gemm6kernel13GemmUniversalINS3_17GroupProblemShapeIN4cute5tupleIJiiiEEEEENS3_10collective13CollectiveMmaINS3_39MainloopSm90ArrayTmaGmmaWarpSpecializedILi4ENS8_IJNS7_1CILi2EEENSE_ILi1EEESG_EEENS3_40KernelPtrArrayTmaWarpSpecializedPingpongEEENS8_IJNSE_ILi64EEENSE_ILi128EEESL_EEENS_10bfloat16_tEPNS8_IJSG_lNSE_ILi0EEEEEESN_PNS8_IJlSG_SO_EEENS7_8TiledMMAINS7_8MMA_AtomIJNS7_4SM904GMMA28MMA_64x128x16_F32BF16BF16_SSILNSW_5MajorE1ELSY_0ELNSW_7ScaleInE1ELSZ_1EEEEEENS7_6LayoutINS8_IJSG_SG_SG_EEENS8_IJSO_SO_SO_EEEEENS8_IJNS7_10UnderscoreES16_S16_EEEEENS7_13SM90_TMA_LOADENS7_14ComposedLayoutINS7_7SwizzleILi3ELi4ELi3EEENS7_18smem_ptr_flag_bitsILi16EEENS12_INS8_IJSK_NSE_ILi8EEEEEENS8_IJSG_SK_EEEEEEEvNS7_8identityENS7_23SM90_TMA_LOAD_MULTICASTENS1A_IS1C_S1E_NS12_INS8_IJS1F_SK_EEENS8_IJSK_SG_EEEEEEEvS1K_EENS_8epilogue10collective18CollectiveEpilogueINS1R_30Sm90PtrArrayTmaWarpSpecializedILi4ELi2ELi16ELb1ELb0ELi2EEEJSM_NS8_IJSK_NSE_ILi32EEEEEESN_SS_SN_SS_NS1R_6fusion15FusionCallbacksIS1V_NS1Y_17LinearCombinationISN_fSN_fLNS_15FloatRoundStyleE2EEESM_S1X_JEEES19_NS1A_INS1B_ILi2ELi4ELi3EEES1E_NS12_INS8_IJS1F_S1W_EEENS8_IJS1W_SG_EEEEEEENS7_17SM75_U32x4_LDSM_NENS7_14SM90_TMA_STOREES28_NS7_17SM90_U32x4_STSM_NENS7_9Copy_AtomIJS2B_NS_6half_tEEEEvEEEvvEEEEEEvNT_6ParamsE'
ptxas info    : (C7510) Potential Performance Loss: wgmma.mma_async instructions are serialized due to wgmma pipeline crossing function boundary at a function call in the function '_ZN7cutlass13device_kernelIN13groupedmm_ext25enable_3x_kernel_for_sm9xINS_4gemm6kernel13GemmUniversalINS3_17GroupProblemShapeIN4cute5tupleIJiiiEEEEENS3_10collective13CollectiveMmaINS3_39MainloopSm90ArrayTmaGmmaWarpSpecializedILi4ENS8_IJNS7_1CILi2EEENSE_ILi1EEESG_EEENS3_43KernelPtrArrayTmaWarpSpecializedCooperativeEEENS8_IJNSE_ILi128EEENSE_ILi256EEENSE_ILi64EEEEEENS_10bfloat16_tEPNS8_IJSG_lNSE_ILi0EEEEEESO_SR_NS7_8TiledMMAINS7_8MMA_AtomIJNS7_4SM904GMMA28MMA_64x256x16_F32BF16BF16_SSILNSV_5MajorE1ELSX_1ELNSV_7ScaleInE1ELSY_1EEEEEENS7_6LayoutISH_NS8_IJSG_SP_SP_EEEEENS8_IJNS7_10UnderscoreES14_S14_EEEEENS7_13SM90_TMA_LOADENS7_14ComposedLayoutINS7_7SwizzleILi3ELi4ELi3EEENS7_18smem_ptr_flag_bitsILi16EEENS11_INS8_IJSM_NSE_ILi8EEEEEENS8_IJSG_SM_EEEEEEEvNS7_8identityENS7_23SM90_TMA_LOAD_MULTICASTES1H_vS1I_EENS_8epilogue10collective18CollectiveEpilogueINS1L_30Sm90PtrArrayTmaWarpSpecializedILi4ELi2ELi16ELb1ELb0ELi2EEEJSN_NS8_IJSK_NSE_ILi32EEEEEESO_PNS8_IJlSG_SP_EEESO_S1T_NS1L_6fusion15FusionCallbacksIS1P_NS1U_17LinearCombinationISO_fSO_fLNS_15FloatRoundStyleE2EEESN_S1R_JEEES17_NS18_INS19_ILi2ELi4ELi3EEES1C_NS11_INS8_IJS1D_S1Q_EEENS8_IJS1Q_SG_EEEEEEENS7_17SM75_U32x4_LDSM_NENS7_14SM90_TMA_STOREES24_NS7_17SM90_U32x4_STSM_NENS7_9Copy_AtomIJS27_NS_6half_tEEEEvEEEvvEEEEEEvNT_6ParamsE'
ptxas info    : (C7510) Potential Performance Loss: wgmma.mma_async instructions are serialized due to wgmma pipeline crossing function boundary at a function call in the function '_ZN7cutlass13device_kernelIN13groupedmm_ext25enable_3x_kernel_for_sm9xINS_4gemm6kernel13GemmUniversalINS3_17GroupProblemShapeIN4cute5tupleIJiiiEEEEENS3_10collective13CollectiveMmaINS3_39MainloopSm90ArrayTmaGmmaWarpSpecializedILi4ENS8_IJNS7_1CILi2EEENSE_ILi1EEESG_EEENS3_40KernelPtrArrayTmaWarpSpecializedPingpongEEENS8_IJNSE_ILi64EEENSE_ILi128EEESL_EEENS_10bfloat16_tEPNS8_IJSG_lNSE_ILi0EEEEEESN_SQ_NS7_8TiledMMAINS7_8MMA_AtomIJNS7_4SM904GMMA28MMA_64x128x16_F32BF16BF16_SSILNSU_5MajorE1ELSW_1ELNSU_7ScaleInE1ELSX_1EEEEEENS7_6LayoutINS8_IJSG_SG_SG_EEENS8_IJSO_SO_SO_EEEEENS8_IJNS7_10UnderscoreES14_S14_EEEEENS7_13SM90_TMA_LOADENS7_14ComposedLayoutINS7_7SwizzleILi3ELi4ELi3EEENS7_18smem_ptr_flag_bitsILi16EEENS10_INS8_IJSK_NSE_ILi8EEEEEENS8_IJSG_SK_EEEEEEEvNS7_8identityENS7_23SM90_TMA_LOAD_MULTICASTES1H_vS1I_EENS_8epilogue10collective18CollectiveEpilogueINS1L_30Sm90PtrArrayTmaWarpSpecializedILi4ELi2ELi16ELb1ELb0ELi2EEEJSM_NS8_IJSK_NSE_ILi32EEEEEESN_PNS8_IJlSG_SO_EEESN_S1T_NS1L_6fusion15FusionCallbacksIS1P_NS1U_17LinearCombinationISN_fSN_fLNS_15FloatRoundStyleE2EEESM_S1R_JEEES17_NS18_INS19_ILi2ELi4ELi3EEES1C_NS10_INS8_IJS1D_S1Q_EEENS8_IJS1Q_SG_EEEEEEENS7_17SM75_U32x4_LDSM_NENS7_14SM90_TMA_STOREES24_NS7_17SM90_U32x4_STSM_NENS7_9Copy_AtomIJS27_NS_6half_tEEEEvEEEvvEEEEEEvNT_6ParamsE'
ptxas info    : (C7510) Potential Performance Loss: wgmma.mma_async instructions are serialized due to wgmma pipeline crossing function boundary at a function call in the function '_ZN7cutlass13device_kernelIN13groupedmm_ext25enable_3x_kernel_for_sm9xINS_4gemm6kernel13GemmUniversalINS3_17GroupProblemShapeIN4cute5tupleIJiiiEEEEENS3_10collective13CollectiveMmaINS3_39MainloopSm90ArrayTmaGmmaWarpSpecializedILi4ENS8_IJNS7_1CILi2EEENSE_ILi1EEESG_EEENS3_43KernelPtrArrayTmaWarpSpecializedCooperativeEEENS8_IJNSE_ILi128EEENSE_ILi256EEENSE_ILi64EEEEEENS_10bfloat16_tEPNS8_IJlSG_NSE_ILi0EEEEEESO_SR_NS7_8TiledMMAINS7_8MMA_AtomIJNS7_4SM904GMMA28MMA_64x256x16_F32BF16BF16_SSILNSV_5MajorE0ELSX_0ELNSV_7ScaleInE1ELSY_1EEEEEENS7_6LayoutISH_NS8_IJSG_SP_SP_EEEEENS8_IJNS7_10UnderscoreES14_S14_EEEEENS7_13SM90_TMA_LOADENS7_14ComposedLayoutINS7_7SwizzleILi3ELi4ELi3EEENS7_18smem_ptr_flag_bitsILi16EEENS11_INS8_IJNSE_ILi8EEESM_EEENS8_IJSM_SG_EEEEEEEvNS7_8identityENS7_23SM90_TMA_LOAD_MULTICASTES1H_vS1I_EENS_8epilogue10collective18CollectiveEpilogueINS1L_30Sm90PtrArrayTmaWarpSpecializedILi4ELi2ELi16ELb1ELb0ELi2EEEJSN_NS8_IJSK_NSE_ILi32EEEEEESO_SR_SO_SR_NS1L_6fusion15FusionCallbacksIS1P_NS1S_17LinearCombinationISO_fSO_fLNS_15FloatRoundStyleE2EEESN_S1R_JEEES17_NS18_INS19_ILi2ELi4ELi3EEES1C_NS11_INS8_IJS1D_S1Q_EEENS8_IJS1Q_SG_EEEEEEENS7_17SM75_U32x4_LDSM_NENS7_14SM90_TMA_STOREES22_NS7_17SM90_U32x4_STSM_NENS7_9Copy_AtomIJS25_NS_6half_tEEEEvEEEvvEEEEEEvNT_6ParamsE'
ptxas info    : (C7510) Potential Performance Loss: wgmma.mma_async instructions are serialized due to wgmma pipeline crossing function boundary at a function call in the function '_ZN7cutlass13device_kernelIN13groupedmm_ext25enable_3x_kernel_for_sm9xINS_4gemm6kernel13GemmUniversalINS3_17GroupProblemShapeIN4cute5tupleIJiiiEEEEENS3_10collective13CollectiveMmaINS3_39MainloopSm90ArrayTmaGmmaWarpSpecializedILi4ENS8_IJNS7_1CILi2EEENSE_ILi1EEESG_EEENS3_40KernelPtrArrayTmaWarpSpecializedPingpongEEENS8_IJNSE_ILi64EEENSE_ILi128EEESL_EEENS_10bfloat16_tEPNS8_IJlSG_NSE_ILi0EEEEEESN_SQ_NS7_8TiledMMAINS7_8MMA_AtomIJNS7_4SM904GMMA28MMA_64x128x16_F32BF16BF16_SSILNSU_5MajorE0ELSW_0ELNSU_7ScaleInE1ELSX_1EEEEEENS7_6LayoutINS8_IJSG_SG_SG_EEENS8_IJSO_SO_SO_EEEEENS8_IJNS7_10UnderscoreES14_S14_EEEEENS7_13SM90_TMA_LOADENS7_14ComposedLayoutINS7_7SwizzleILi3ELi4ELi3EEENS7_18smem_ptr_flag_bitsILi16EEENS10_INS8_IJNSE_ILi8EEESK_EEENS8_IJSK_SG_EEEEEEEvNS7_8identityENS7_23SM90_TMA_LOAD_MULTICASTES1H_vS1I_EENS_8epilogue10collective18CollectiveEpilogueINS1L_30Sm90PtrArrayTmaWarpSpecializedILi4ELi2ELi16ELb1ELb0ELi2EEEJSM_NS8_IJSK_NSE_ILi32EEEEEESN_SQ_SN_SQ_NS1L_6fusion15FusionCallbacksIS1P_NS1S_17LinearCombinationISN_fSN_fLNS_15FloatRoundStyleE2EEESM_S1R_JEEES17_NS18_INS19_ILi2ELi4ELi3EEES1C_NS10_INS8_IJS1D_S1Q_EEENS8_IJS1Q_SG_EEEEEEENS7_17SM75_U32x4_LDSM_NENS7_14SM90_TMA_STOREES22_NS7_17SM90_U32x4_STSM_NENS7_9Copy_AtomIJS25_NS_6half_tEEEEvEEEvvEEEEEEvNT_6ParamsE'
ptxas info    : (C7510) Potential Performance Loss: wgmma.mma_async instructions are serialized due to wgmma pipeline crossing function boundary at a function call in the function '_ZN7cutlass13device_kernelIN13groupedmm_ext25enable_3x_kernel_for_sm9xINS_4gemm6kernel13GemmUniversalINS3_17GroupProblemShapeIN4cute5tupleIJiiiEEEEENS3_10collective13CollectiveMmaINS3_39MainloopSm90ArrayTmaGmmaWarpSpecializedILi4ENS8_IJNS7_1CILi2EEENSE_ILi1EEESG_EEENS3_43KernelPtrArrayTmaWarpSpecializedCooperativeEEENS8_IJNSE_ILi128EEENSE_ILi256EEENSE_ILi64EEEEEENS_10bfloat16_tEPNS8_IJlSG_NSE_ILi0EEEEEESO_PNS8_IJSG_lSP_EEENS7_8TiledMMAINS7_8MMA_AtomIJNS7_4SM904GMMA28MMA_64x256x16_F32BF16BF16_SSILNSX_5MajorE0ELSZ_1ELNSX_7ScaleInE1ELS10_1EEEEEENS7_6LayoutISH_NS8_IJSG_SP_SP_EEEEENS8_IJNS7_10UnderscoreES16_S16_EEEEENS7_13SM90_TMA_LOADENS7_14ComposedLayoutINS7_7SwizzleILi3ELi4ELi3EEENS7_18smem_ptr_flag_bitsILi16EEENS13_INS8_IJNSE_ILi8EEESM_EEENS8_IJSM_SG_EEEEEEEvNS7_8identityENS7_23SM90_TMA_LOAD_MULTICASTENS1A_IS1C_S1E_NS13_INS8_IJSM_S1F_EEENS8_IJSG_SM_EEEEEEEvS1K_EENS_8epilogue10collective18CollectiveEpilogueINS1R_30Sm90PtrArrayTmaWarpSpecializedILi4ELi2ELi16ELb1ELb0ELi2EEEJSN_NS8_IJSK_NSE_ILi32EEEEEESO_SR_SO_SR_NS1R_6fusion15FusionCallbacksIS1V_NS1Y_17LinearCombinationISO_fSO_fLNS_15FloatRoundStyleE2EEESN_S1X_JEEES19_NS1A_INS1B_ILi2ELi4ELi3EEES1E_NS13_INS8_IJS1F_S1W_EEENS8_IJS1W_SG_EEEEEEENS7_17SM75_U32x4_LDSM_NENS7_14SM90_TMA_STOREES28_NS7_17SM90_U32x4_STSM_NENS7_9Copy_AtomIJS2B_NS_6half_tEEEEvEEEvvEEEEEEvNT_6ParamsE'
ptxas info    : (C7510) Potential Performance Loss: wgmma.mma_async instructions are serialized due to wgmma pipeline crossing function boundary at a function call in the function '_ZN7cutlass13device_kernelIN13groupedmm_ext25enable_3x_kernel_for_sm9xINS_4gemm6kernel13GemmUniversalINS3_17GroupProblemShapeIN4cute5tupleIJiiiEEEEENS3_10collective13CollectiveMmaINS3_39MainloopSm90ArrayTmaGmmaWarpSpecializedILi4ENS8_IJNS7_1CILi2EEENSE_ILi1EEESG_EEENS3_40KernelPtrArrayTmaWarpSpecializedPingpongEEENS8_IJNSE_ILi64EEENSE_ILi128EEESL_EEENS_10bfloat16_tEPNS8_IJlSG_NSE_ILi0EEEEEESN_PNS8_IJSG_lSO_EEENS7_8TiledMMAINS7_8MMA_AtomIJNS7_4SM904GMMA28MMA_64x128x16_F32BF16BF16_SSILNSW_5MajorE0ELSY_1ELNSW_7ScaleInE1ELSZ_1EEEEEENS7_6LayoutINS8_IJSG_SG_SG_EEENS8_IJSO_SO_SO_EEEEENS8_IJNS7_10UnderscoreES16_S16_EEEEENS7_13SM90_TMA_LOADENS7_14ComposedLayoutINS7_7SwizzleILi3ELi4ELi3EEENS7_18smem_ptr_flag_bitsILi16EEENS12_INS8_IJNSE_ILi8EEESK_EEENS8_IJSK_SG_EEEEEEEvNS7_8identityENS7_23SM90_TMA_LOAD_MULTICASTENS1A_IS1C_S1E_NS12_INS8_IJSK_S1F_EEENS8_IJSG_SK_EEEEEEEvS1K_EENS_8epilogue10collective18CollectiveEpilogueINS1R_30Sm90PtrArrayTmaWarpSpecializedILi4ELi2ELi16ELb1ELb0ELi2EEEJSM_NS8_IJSK_NSE_ILi32EEEEEESN_SQ_SN_SQ_NS1R_6fusion15FusionCallbacksIS1V_NS1Y_17LinearCombinationISN_fSN_fLNS_15FloatRoundStyleE2EEESM_S1X_JEEES19_NS1A_INS1B_ILi2ELi4ELi3EEES1E_NS12_INS8_IJS1F_S1W_EEENS8_IJS1W_SG_EEEEEEENS7_17SM75_U32x4_LDSM_NENS7_14SM90_TMA_STOREES28_NS7_17SM90_U32x4_STSM_NENS7_9Copy_AtomIJS2B_NS_6half_tEEEEvEEEvvEEEEEEvNT_6ParamsE'
[3/3] c++ bindings.o GroupMM.cuda.o -shared -L/home/jeromeku/cutlass/.cutlass-env/lib/python3.12/site-packages/torch/lib -lc10 -lc10_cuda -ltorch_cpu -ltorch_cuda -ltorch -ltorch_python -L/usr/lib64 -lcudart -o groupedmm_ext.so
Allocated out size: [64, 32]
A: [64, 64] [64, 1]
B: [4, 64, 32] [2048, 1, 64]
Created tensor out with: [64, 32] [32, 1] BFloat16
Calling bf16 kernel with shapes: [64, 64], [4, 64, 32], [64, 32]
Allocated out size: [64, 32]
A: [64, 64] [64, 1]
B: [4, 64, 32] [2048, 1, 64]
Created tensor out with: [64, 32] [32, 1] BFloat16
Calling bf16 kernel with shapes: [64, 64], [4, 64, 32], [64, 32]
